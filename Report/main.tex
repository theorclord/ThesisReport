\documentclass[a4paper,11pt]{report}
\usepackage{xr}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{scrextend}
\usepackage[english]{babel}
\usepackage[vmargin=3.5cm, top=2cm]{geometry}
\usepackage[linktocpage=true]{hyperref}
\usepackage{enumitem}
\usepackage{longtable}
\usepackage{pdfpages}
\usepackage[font=small,labelfont=bf]{caption}
\usepackage{float}
\usepackage{hyperref}
\usepackage[section]{placeins}
\usepackage{listings}
\usepackage{url}
\urlstyle{same}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}
\newcommand{\tmtable}{\begin{longtable}{ p{2.7cm} p{10cm} }}
\newcommand{\tmtableend}{\end{longtable}}
\renewcommand{\baselinestretch}{1.0} 

\begin{document}
\lstset{language=C}
 
\begin{titlepage}

\centering \parindent=0pt
\newcommand{\HRule}{\rule{\textwidth}{1mm}}
\vspace*{\stretch{1}} \HRule\\[1cm]\large\bfseries
Exploring the design space and technical challenges of Procedural Content Generation integration in hybrid games\\[0.7cm]
\large Masters Project\\[1cm]
\HRule\\[1cm]

\begin{figure}[!ht]
	\centering
    \includegraphics[width=1\textwidth]{Images/LOGO.png}
    \label{fig:frontPage}
\end{figure}
\large by 
\\Mats Stenhaug (msten@itu.dk)
\\Maxime Moze (mafm@itu.dk)
\\Mikkel Stolborg (msto@itu.dk)
\vspace*{\stretch{2}} \normalsize
\begin{flushleft}
IT University of Copenhagen \\
Supervisors\\
Gordon Calleja\\
Joel Anthony Lehman\\
\today \end{flushleft}
\end{titlepage}

\begin{abstract}
Some intro about what procedural content generation is.
Some intro about what board games are.
Intro to our project.
What have been produced.
Conclusion.\\\\

The world of games is growing rapidly, especially the digital game world which is putting more pressure on the analogue games. As an attempt to combine these two worlds, the hybrid games emerge, and we want to explore this space and the challenges that comes with integrating Procedural Content Generation into the digital merging of analogue gaming. Procedural Content Generation, PCG, allows for game content to be generated at run-time, and removes the need for physical elements such as cards, dice and reference-sheets and other aspects that are normally contained within the typical board games. As board games usually require a rule-set that explains how certain actions happen, it is our hopes that using PCG in a hybrid adaptation of a game, will shed light upon areas where board games and digital games can come together and shine as a hybrid. In this project we will produce a hybrid game called \textit{Archipelago} which will consist of both a physical board with a layout and the typical tokens, and it will have a digital application that will be used coherently with the physical part. This paper will explain upon the PCG algorithms used within the app, the thoughts behind them and the results that they bring, along with the design challenges that appears when creating a hybrid game and theory and examples of other existing hybrid games.


\end{abstract}
\pagebreak
\tableofcontents
\pagebreak
\listoffigures
\pagebreak
\include{introduction}
\pagebreak
\include{background}
\pagebreak
\include{methods}
\pagebreak
\include{application}
\pagebreak
\include{results}
\pagebreak
\include{discussion}
\pagebreak
\include{conclusion}
\pagebreak
%\bibliography{sources}{}
%\bibliographystyle{plain}
\begin{thebibliography}{1}

%\bibitem{bibitemName}
%Book and articles
%Author 1, Author 2, and Author 3 (Year of publication) \emph{Title of article or book}, Place of print and or writing: publisher.

%\bibitem{bibitemName1}
%Board Game
%Designer (Year of publication) \emph{Title of Game} [Board game], Place of publication: publisher.

%\bibitem{bibitemName2}
%Video Game
%Studio (Year of publication) \emph{Title of Game} [Video game],  First release Platform, Place of publication: publisher.

%A
\bibitem{art:aarseth}
Aarsen, E. (2012). A Narrative Theory of Games. In \textit{Proceedings of the International Conference on the Foundations of Digital Games - FDG'12} [online]. Available at: \url{http://dl.acm.org/citation.cfm?id=2282365}. [Accessed 25 May 2016].  
\bibitem{game:candy}
Abbot, E. (1949).\textit{Candy Land} [Board Game]. Milton Bradley Company.

\bibitem{game:cah}
Ad Magic Inc (2011). \textit{Cards Against Humanity} [Card Game].

%B
\bibitem{web:golem}
Banks, D. (2014).\textit{Digitally-Enhanced Boardgames Have Arrived and Golem Arcana Is a Winner} [online]. GeekDad. Available at: \url{https://geekdad.com/2014/09/golem-arcana-reviewed/}. [Accessed 3 Dec. 2015].

\bibitem{pdf:use}
Bevan, N. (2009).\textit{What is the difference between the purpose of usability and user experience evaluation methods?} [pdf]. Available at: \url{http://www.nigelbevan.com/papers/What_is_the_difference_between_usability_and_user_experience_evaluation_methods.pdf}. [Accessed 1 September 2015].

\bibitem{game:diablo}
Blizzard North (1996). \textit{Diablo} [Video game]. Microsoft Windows. Blizzard Entertainment.

\bibitem{game:hs}
Blizzard Entertainment (2014). \textit{Hearthstone: Heroes of Warcraft} [Video game]. Windows, OS X, iOS, Android.   Blizzard Entertainment

\bibitem{game:zombies}
Breitenstein, T. and Breitenstein, K. (2001). \textit{Zombies!!!} [Board game]. Twilight Creations.

%C
\bibitem{book:mpg}
Caillois, R. (2001). \textit{Man, Play and Games}. Trans. by Barash, M. Urbana, Illinois, USA: University of Illinois Press.

\bibitem{game:diplo}
Calhamer, A.B. (1959). \textit{Diplomacy} [Board game].

\bibitem{game:atmo}
Clements, B., Tanner, P. (1991). \textit{Nightmare} [Board game]. J. W. Spear \& Sons.

\bibitem{game:ages}
Chvátil, V. (2006). \textit{Through the Ages: A Story of Civilization} [Board game]. Czech Board Games.

%D
\bibitem {game:mono}
Darrow, C. (1935). \textit{Monopoly}. Parker Brothers.

\bibitem{chap:aug}
De Boer, C. and Lamers, M. (2004). Electronic Augmentation of Traditional Board Games. In: M. Rauterberg, ed., Entertainment Computing - ICEC 2004, 1st ed. Eindhoven: Springer, pp.441 - 444.

%\bibitem{game:dnd}
%Wizards of the Coast (1974). \textit{Dungeons \& Dragons} [Role playing table-top game]

%E
\bibitem{game:gar}
Evolutionary games (2010). \textit{Galactic Arms Race} [Video game]. Microsoft Windows. 

%G
\bibitem{game:border}
Gearbox Software (2009). \textit{Borderlands} [Video game]. Microsoft Windows, Playstation 3, Xbox 360. 2K Games.

\bibitem{game:dnd}
Gigax, G. and Arneson, D. (1974) \textit{Dungeons and Dragons} [Tabletop Role Playing Game]. Tactical Studies Rules. Inc.

\bibitem{game:zombi}
Guiton, R. Lullien, J-B. and Raoult, N. (2012). \textit{Zombicide} [Board Game]. Guillotine Games.

%H
\bibitem{game:golem}
Harebrained Schemes (2014). \textit{Golem Arcana}. Harebrained Schemes.

\bibitem{book:proto}
Houde, S. and Hill, C. (1997). \textit{What do prototypes prototype?}. 1st ed. [pdf]. Cupertino, CA, USA, pp.1 - 16. Available at:\url{https://www.semanticscholar.org/paper/What-do-Prototypes-Prototype--Houde-Hill/30bc6125fab9d9b2d5854223aeea7900a218f149/pdf}. [Accessed 1 Sep. 2015].

%J
\bibitem{film:lotr2}
\textit{The Lord of the Rings: The Two Towers} (2002). Directed by Peter Jackson [Film]. New Zealand, USA: New Line Cinema.

\bibitem{film:lotr3}
\textit{The Lord of the Rings: The Return of the King} (2003). Directed by Peter Jackson [Film]. New Zealand, USA: New Line Cinema.

%K
\bibitem{game:tw}
Keyaerts, P. (2009).\textit{Small World} [Board Game]. Days of Wonder.

\bibitem{game:alch}
Kotry, M. (2014). \textit{Alchemists} [Board Game]. Czech Games Edition.

%L
\bibitem{web:wired}
Flaherty, J. (2012). \textit{Zombicide App Digitally Enhances an Elaborate Board Game} [online]. WIRED. Available at: \url{http://www.wired.com/2012/09/zombicide-app/}. [Accessed 3 May 2016].

\bibitem{game:xcomtbg}
Lang, E-M.(2015). \textit{XCOM: The Board Game} [Board game]. Fantasy Flights Games.

\bibitem{game:desert}
Leacock, M. (2013). \textit{Forbidden Desert} [Board game].  Gamewright.

\bibitem{game:race}
Lehmann, T. (2007). \textit{Race for the Galaxy} [Card game]. Rio Grande Games.

\bibitem{web:oak}
Levan, N. (2014). \textit{Gaming Glossary: Boardgame, Tabletop game, Card game} [online]. Availabe at: \url{https://oakleafgames.wordpress.com/2014/07/10/gaming-glossary-boardgame-tabletop-game-card-game/}. [Accessed: 1 May 2016]

\bibitem{book:proto2}
Lim, Y., Stolterman, E. and Tenenberg, J. (2008). The anatomy of prototypes in \textit{ACM Transactions on Computer-Human Interaction}, 15(2), pp.1-27.

%M
\bibitem{art:stars}
Magerkurth, C., Stenzel, R., Prante, T. (2003). STARS - A Ubiquitous Computing Platform for Computer Augmented Tabletop Games. in Ljungstrand, P. and Brotherton, J. (Ed.) \textit{Video Track and Adjunct Proceedings of the Fifth
International Conference on Ubiquitous Computing (UBICOMP’03)}, Seattle, Washington, USA.

\bibitem{art:stars2}
Magerkurth, C., Engelke, T. and Memisoglu, M. (2004). Augmenting the virtual domain with physical and social elements. in \textit{Computers in Entertainment (CIE) - First anniversary issue}. 2(4), p.12. 

\bibitem{art:prophets}
Mandryk, R. and Maranan, D. (2002). False prophets. in \textit{CHI '02 extended abstracts on Human factors in computing systems - CHI '02}.

\bibitem{web:poly}
McElroy, G. (2013).\textit{Cardboard empires: How digital is supporting, not killing board games} [online]. Polygon. Available at: \url{http://www.polygon.com/2013/11/26/5131050/cardboard-empires-how-digital-is-supporting-not-killing-board-games}. [Accessed 14 Apr. 2016].

\bibitem{game:outthere}
Mi-Clos Studio (2014). \textit{Out There} [Video Game]. Android, iOS. Mi-Clos Studio.

\bibitem{game:shadowMordor}
Monolith Productions (2014). \textit{Middle-Earth: Shadow of Mordor} [Video game]. Microsoft Windows, PlayStation 4, Xbox One, PlayStation 3, Xbox 360. Kirkland, Washington, USA: Monolith Productions.

\bibitem{game:ticket}
Moon, A.R. (2004). \textit{Ticket to Ride} [Board Game]. Days of Wonder.

\bibitem{game:xcom}
Mythos Games and MicroProse (1994). \textit{UFO: Enemy Unknown} [Video game]. Microsoft Windows, MS-DOS, Amiga, Amiga 1200, Amiga CD32. USA: MicroProse.

%O
\bibitem{web:lsys}
Gabriela Ochoa. (1998). \textit{An Introduction to Lindenmayer Systems} [online]. Available at:  \url{http://ldc.usb.ve/~gabro/lsys/lsys.html}.[Accessed 24 May 2016].

\bibitem{web:oxford}
Oxforddictionaries.com. (2016). \textit{board game - definition of board game in English from the Oxford dictionary} [online]. Available at:  \url{http://www.oxforddictionaries.com/definition/english/board-game?q=Board+game}.[Accessed 1 May 2016].

%R
\bibitem{soft:massive}
Regelous, S. (n.d.). \textit{MASSIVE}. Wellington, New Zealand: Weta Digital.

\bibitem{game:agri}
Rosenberg, U. (2007). \textit{Agricola}. Ystari Games.

%S
\bibitem{book:id}
Saffer, D. (2010). \textit{Design for Interaction: Creating Innovative Applications and Devices}. Berkeley, California, USA: New Riders.

\bibitem{book:rop}
Salen, K., and Zimmerman, E. (2003). \textit{Rules of Play: Game Design Fundamentals}. Cambridge, Massachusetts: MIT Press.

\bibitem{pdf:smith}
Smith, G. (2012). textit{Expressive Design Tools: Procedural Content Generation for Game Designers} [online]. UC Santa Cruz: Computer Science. Available at: http://escholarship.org/uc/item/0fn558gq. [Accessed 14 Dec. 2015]

\bibitem{pdf:pcgbased}
Smith, G., Gan, E., Othenin-Girard, A. and Whitehead, J. (2011). \textit{PCG-Based Game Design: Enabling New Play Experiences through Procedural Content Generation}. [pdf] Santa Cruz, CA, USA: Center for Games and Playable Media, University of California. Available at: \url{https://www.researchgate.net/publication/229020641_PCG-based_game_design_Enabling_new_play_experiences_through_procedural_content_generation}. [Accessed 14 Dec. 2015].

\bibitem{game:ftl}
Subset Games (2012). \textit{FTL: Faster Than Light} [Video game]. iOS, OS X, Linux, Microsoft Windows. Subset Games.

\bibitem{prog:slack}
Slack - \url{https://slack.com/}

\bibitem{art:stenroswaern}
Stenros, J. and Waern, A. 2010. \url{https://www.inter-disciplinary.net/wp-content/uploads/2010/06/Stenros-Waern-paper.pdf}. [Accessed 30 May. 2016].

%T
\bibitem{art:whatpcg}
Togelius, J., Kastbjerg, E., Schedl, D. and Yannakakis, G.N. (2011) \emph{What is Procedural Content Generation? Mario on the borderline}, IT University of Copenhagen, Copenhagen, Denmark.

\bibitem{game:rogue}
Toy, M., Witchman, G., Arnold, K. (1980). \textit{Rogue} [Video game]. Unix.

\bibitem{prog:trello}
Trello - \url{https://trello.com/}


%U
\bibitem{engine:unity}
Unity3D Game Engine, Unity Technologies.
\url{http://unity3d.com}

%V
\bibitem{art:pcg}
Van der Linden, R., Lopez, R., Bidarra, R. (March 2014), \textit{Procedural generation of dungeons}, Delft University of Technology, The Netherlands.

%W
\bibitem{book:euro}
Woods, S. (2012). \textit{Eurogames: The Design, Culture and Play of Modern European Board Games}. Jefferson, Missouri, North Carolina and London: McFarland \& Co.

\bibitem{game:carca}
Wrede, K.J. (2000). \textit{Carcassonne} [Board game]. Hans im Glück Verlags-GmbH.

%Y
\bibitem{art:edpcg}
Yannakakis, G. N., Togelius, J. (2011). \textit{Experience-Driven Procedural Content Generation},IT University of Copenhagen, Copenhagen, Denmark.

%Z
\bibitem{art:collab}
Zagal, J. and Rick,J. (2006). Collaborative games: Lessons learned from board games in \textit{Simulation \& Gaming}, 37(1), 24-40 [online]. Available at: \url{https://home.cc.gatech.edu/je77/uploads/3/hobbits-sg.pdf}

\bibitem{art:exppcg}
Georgios N. Yannakakis and Julian Togelius, \emph{Experience-Driven Procedural Content2008.Generation}, Member, IEEE, 2011.
{juto, eeka, dasc, yannakakis}@itu.dk

\bibitem{book:cad}
K. Lalit Narayan, K. Mallikarjuna Rao, and M.M.M. Sarcar, \emph{Computer Aided Design and Manufacturing}, Prentice-Hall of India Private Limited, New Delhi, India, 1 Dec 2008.

\end{thebibliography}
\pagebreak
\appendix
\chapter{Concept Brainstorm}
\begin{figure}[h]
    \centering
    \includegraphics[scale=0.18,angle=-90]{Images/Brainstorm1.png}
    \caption{The first mind map exploring the ideas behind the PCG-based app integration in board games.}
    \label{fig:brainstorm1}
\end{figure}
\chapter{Second Brainstorm}
\begin{figure}[h]
    \centering
    \includegraphics[scale=0.25,angle=-90]{Images/Brainstorm2.png}
    \caption{Mind map based on the core concept of exploring the different possibilities.}
    \label{fig:brainstorm2}
\end{figure}
\chapter{Digital implementation prototype}
\begin{figure}[!ht]
   \centering
   \begin{subfigure}[b]{\textwidth}
       \includegraphics[width=\textwidth]{Images/proto2.jpg}
       \caption{Playtest based on another iteration of the board mechanics.}
       \label{fig:flowtest}
   \end{subfigure}
   \begin{subfigure}[b]{\textwidth}
       \includegraphics[width=\textwidth]{Images/proto2map.png}
       \caption{Map layout. The nodes do not contain the events, which are still simulated with dice roll.}
       \label{fig:flowmap}
   \end{subfigure}
   \caption{Testing the implementation of a digital component within the game flow.}
   \label{fig:gameflow}
\end{figure}

\chapter{High level walk through of the app}
\section{Generate Events}
\label{overviewapp}
In the world map, all the islands that were generated are being displayed. And when the player moves the castle to an island, i.e. goes to explore it, a new screen will be shown to the players, called the NodeScene. This screen is showing the island and the "explorable" locations on it. But before they can be displayed, they need to be built. 

\section{How an event is built}
An event is generated by selecting which type of event it is going to be; Gathering or Research. Both of these event types have 5 different location types affiliated with them. Mines, quarry etc. for the gathering, and Lake, forest etc. for the research. As soon as the event type is selected, a location is also selected. Now the algorithm goes into an XML file containing all the different rewards and conditions, and picks a number of them; 1, 2 or 3 different options that the players can select from. Associated with all the conditions used in the event, there are a list of possible outcomes that can happen if said condition is chosen, be it gaining resources or losing player tokens. The outcomes of every event is changed by the current standing the players have with the faction controlling the island the players are currently on. 
Once the options and outcomes have been generated, the location icons will be loaded to the island, and the players are free to choose which one they would like to explore.

\section{Moving around the world}
The main course of the game is to move from the start all the way to the goal node. But the castle can only move a certain length each turn. This means that the players will have to plan their way by looking at which island they can reach at any given time. The layout however is made so that the castle that is being moved, always is able to reach at least 1 island each turn. If there are more than 1 island within the ring surrounding the castle (indicator for where they can move to), it is up to the players to choose where they want to go, and which direction to take. There is always the little arrow in the lower right corner of the screen, indicating which direction the final goal is. The players are always welcome to go back where they came from, and travel to already visited islands, though they will not be able to "re-explore" them. So should the players by chance start off going the wrong way, it does not ruin the game for them and make them unable to return.

\section{Interacting with the islands}
In order to travel to an island, you will have to click on the sprite image that is representing them in the world map. The island also have to be within range of the castle in order for any interaction to be possible. 
Once you click on the island, you will be greeted with a pop-up box that will ask you to confirm that you want to travel there. If this is the case, just hit the "travel" button, and the castle is on it's way. If however you change your mind for some reason, and wish to travel to another island, you can either move the viewport a little (click outside the box) or you can travel there, and go back later, or click the close button. If you click outside the box or the close button, the box will close, and you are free to select an alternative route.

When you have reached the island and the next scene is loaded, you will be able to choose from the possible variations of locations on the island. As mentioned before, there are a number of different types of locations, and each of them have their own look, feel and purpose.
A location point is clicked on and as it is a sprite, the click has to be registered via raycasting. The touch on the screen has its location found, and a ray is then cast between the touch point and the world point within the app, and if the resulting ray goes through the sprite with the location attached to it, the event will begin. When the event begins, the possible options, outcomes and the success indicator; good, bad or neutral and the rewards or penalties associated with them, will be presented to the user.

\section{Flavour text combinations and it's purpose}
Being a hybrid between a board game and a digital game, it is important that the players are presented with text that they can read in order to get into the feel of the game, and the setting in which it takes place. This means that there was a need for a lot of flavour text that will tell the players these things. 

Every island has a name and a short piece of text along with it. These texts are premade and are applied to the island when they are generated in the beginning. 
It is in the events that the real challenge is. The flavour text for the events needed to be linked with the location type, i.e. if the location type is a lake, the text needs to reflect that the area is a lake. So in order to make this happen, every location have a number of premade text strings associated with them, and one of those are selected as soon as the event is generated. On top of that, one of the bigger challenges was to have flavour for all the options, or buttons, that the players would be able to select from. The text needed to be based on what the players are using and it needs to be able to be combined with more text in case there are more than one board piece required for the option. The flavour also needs to be somehow connected with the type of location, so if you were at a lake and had to send out a castle crew, the text would say something like "send a crew down to the lake" instead of saying "send a crew to explore". The feel that it is connected and not just generic for everything, is important, as without it, one could just as easily have a deck of cards. 

Now that all the conditions have been "flavourized", the challenge moves on to the result flavour. This is the flavour that is being shown as soon as an option is selected. It is constructed by combining strings of text that are based on the resulting rewards. So if you get 1 piece of Alchemical Material pluss 1 crystal charge, the resulting finished flavour text would look something like "You found a new piece of material when you were exploring. As you enter the castle again you notice that within your findings, were a piece of shiny crystal". 
This concept goes for all possible combinations of result flavour. And each piece is selected from a variety of strings associated with each type of reward and penalty. By having all these pieces being able to be combined, we remove the need for having a huge bunch of cards on the table, as all the "cards" are being made procedurally. Also we can just make more blocks of text and by doing so we are creating another deck of cards for each piece of text added.

The exact way the different flavours are combined, is described in the event section above.

\section{Using memory to generate special event occurrences}

Special events is a feature that takes use of the fact that the application has memory. By checking the previous events, conditions and overall parameters within the data, we can compare the data and check how everything is connected. In doing so, we can make a list of conditions that needs to be met within an event, in order for a special event to be triggered and created. What we do as of now, is to have very specific requirements for an event to be able to trigger the special events. If the original event has a 3rd option, which is the "special" option, a check will be made to see if the overall conditions of the event checks out in comparison to the list of special events.
For instance; a special event will be triggered if a preceding event was affiliated with the faction "Highbournes", and the location was a forest. Then the special event will occur on the world map X turns later, determined by a random initializer integer. When said special event then is triggered, it will use the data saved from the event that triggered it, and check which option was chosen, what the conditions for that option was, and then generate the text and result from that data.

All the resulting data is then also saved into the datamanager class, and the values are updated, e.g. the reputation with a faction increases/decreases, etc.


This concept of having special events being triggered and be based on already saved data, is one that really separates this game from being just a board game, to being something of a more technological game. There are a lot of different way this data can be used, and this is just one of them. More ways and our thoughts and ideas on this matter will be discussed in the discussion section.

\end{document}